#! https://zhuanlan.zhihu.com/p/680368784

# 垃圾佬的服务器研究记录（缓慢更新）

## 前言

**我不是专业垃圾佬，有错误欢迎指正**

众所周知，垃圾佬的服务器百花齐放，最丐的有几十元矿板、路由器、工控机等，最高的有刀箱插满等

捡垃圾都是大伙的爱好，真实情况可能大伙个顶个的有钱（虽然至少我不是）

对于垃圾佬而言，所谓服务器其实不是某种特定机型，比如机架、刀片这种，而是任何能够执行所需服务的机器，也因此诞生出很多奇葩的垃圾佬特有的“服务器”

于是我萌生了一个想法就是把这些花哨方案做个大合集，这样就能给想折腾的垃圾佬们扩展一下可选方案

由于财力不足，很多东西我自己没玩过，大多都是参考别人的视频或者官方介绍，而且价位时常变动，因此并不一定适合作为特定预算参考方案，只能开阔下眼界啥的

## 介绍

在详细介绍型号前需要介绍一些基本的硬件知识

### 芯片组

现在比较流行的是x99主板，但是x99主板不一定是真的x99芯片组，所谓寨板就是不一定采用原生x99芯片组的主板，都是山寨厂商自己折腾的，有的可能上到C612芯片组，有的可能是B85、[H81](http://www.huananzhi.com/more.php?lm=10&id=784)、[H55、P55](http://www.huananzhi.com/more.php?lm=10&id=870)、[Q87](http://www.huananzhi.com/more.php?lm=10&id=318)

为何能够通用呢？首先看插槽（这里指改完后呈现的插槽），都是FCLGA2011又或者说2011-3（最近看见个视频，甚至2011也即X79的放上去都能点亮，不知道是不是特例[2024科技奇迹！抽象！太抽象了！](https://www.bilibili.com/video/BV1de411a72A/?t=217)）

![V3V2V1compare](./pics/V3V2V1compare.png)

![V4V3and6thcompare](./pics/V4V3and6thcompare.png)

当然，插槽一样也只能说你能插上去，具体能不能点亮还要看芯片组，在X99及之前时代的芯片组没有阉割对服务器U的支持，所以就能出现华南这种用别的芯片组配合对应插槽使用的情况

然而现在的消费级芯片组普遍是不支持服务器或者工作站的CPU的，比如10代的工作站主板w480能用w-1200系但是z490不能用

而这种以次充好的操作自然会缺少一些功能，比如C612芯片组能够支持单条64GB内存，C602芯片组也能，但是其它的基本都不支持

以及除了服务器芯片组能支持双路及以上外其余芯片组都不能支持

![X99H61compare](./pics/X99H61compare.png)

![X99C612compare](./pics/X99C612compare.png)

越往后企业级与消费级芯片组的功能差异就越大，但一般用户也基本碰不到那么多高级功能就是了

### 扩展性

很多人买服务器或工作站基本都是为了扩展性，比如40多条PCIE通道，12代也才20，10代也才12

关于通道我推荐个视频[【11006】CPU的PCIe通道在主板上是如何分配的？PCIe设备与固态硬盘到底应该安装在哪个插槽上？](https://www.bilibili.com/video/BV1cC4y1C7kP)

经常听到X16、X8等说法，并不一定是真实占用通道数，一些主板会自动拆分，有的阴间些的当你插多一张网卡，两个X16都变成X8会搞得显卡跑不满带宽，高端的主板基本都有更好的拆分功能，低端的有的只能自动拆分，占满了就可能导致设备无法使用

---

其次就是内存的上限，看前面的图可以知道消费级支持的最大内存对比企业级来说九牛一毛，而且支持的通道相差也巨大，消费级现在还是双通道而企业级六通道、八通道都有

同时企业级可能使用更高级的技术让一个通道用三根内存条，可看[这主板真残暴：24条内存插槽 1.5TB DDR4（原帖没了，换了个）](https://read01.com/BynPQB.html)

这里双U，单U四通道，两个加起来应该也就八通道16根内存条，可是为什么能上24根就是因为其内存控制器不同

同理，现在也有32根甚至更多内存条的主板

再再上就要用内存扩展板了，比如如下主板一看就知道不是正常插内存条的，而它支持96根内存条

![X10QBi](./pics/X10QBi.jpeg)

举例个具体型号就是DELL R930，而它的内存扩展卡（memory riser）大致是这样

![MemoryRiser](./pics/MemoryRiser.jpeg)

至于怎么插，用的什么技术我就不知道了，抱歉这个太高级了真的是知识盲区

---

然后就是多路了，除了服务器芯片组外都不支持双路及以上

以常见的服务器U（A、I两家，N的太新暂不考虑）
AMD最多双路，Intel最多8路

刀箱可塞若干（比如16个）刀片服务器，每片可有多路，比如M1000e最高可用32个CPU

### 编号

AMD中带P的是单路型号，其余的最高可到双路

最后的数字是代数，比如7551P就是第一代而且只能单路


Intel的则是看前缀第一个数字，1、2、3或4、5或6、8或9代表1、2、4、6、8路，同时也分为铜牌（3）、银牌（4）、金牌（5或6）、铂金牌（8或9）

需要注意的是1、2比如e3 1230、e5 2666这些是老一代的至强（Xeon）CPU，现在命名规则有所改变

第二个数字是代数，比如6133就是第一代至强可扩展CPU

最后的字母代表其有特点，比如M代表支持更大内存，L代表更加省电（恕我直言，虽然我觉得这种分类非常好，但是有时候类太多了搜着也烦）

[关于英特尔® 处理器编号](https://www.intel.cn/content/www/cn/zh/products/docs/processors/processor-numbers-data-center.html)

更多细节待日后补充，因为分支太多了，只能先挑大伙主要看的服务器用的cpu写，工作站、嵌入式等暂不考虑，虽然估计很多人想组个软路由

### 如何查资料

最好就是官网能找到的，比如超微（SuperMicro）、intel、amd、nvidia、技不如人、打人硕等官网都有详细资料，其次就是上各个硬件测试网站找对应型号，毕竟es的资料通常官方不会写，可以去cpuz、user benchmark等网站大致对比性能差距

然后能找到，接下来要学怎么看，这里以超微官网来说，首先看超微，点开“所有产品”，第一栏是成品服务器的介绍，不想折腾想上整机的可以找老型号直接照着买二手，当然超微的很贵，建议是找戴尔（Dell）、联想（Lenovo）的型号买，这里主要是超微还能顺便查主板型号方便点

![SupermicroServers](./pics/SupermicroServers.png)

主要看的还是这里，因为很多成品服务器都有用超微的主板，所以最后你淘二手服务器多少还是会来到超微这边做参考

![SupermicroBuildingBlocks](./pics/SupermicroBuildingBlocks.png)

![SupermicroFilters](./pics/SupermicroFilters.png)

随便选取一个主板

![X11DSF-E](./pics/X11DSF-E.png)

底下还有更详细的信息但是太长了不想放，大致如下：

支持一二代至强可扩展CPU最高双路，CPU最高TDP 205W（比如240W的8124m就不支持，除非破解）

使用C627芯片组（和C621类似都差不多是一批只是功能略有不同，硬件基本通用）

最高6TB RECC DDR4 2933Mhz 内存，能用低压条（LRDIMM，可用64、128GB的，RDIMM还能用32GB的），有24个槽，同时在使用二代至强可扩展CPU时能支持傲腾内存条

一条PCIE 3.0X32的Riser槽，通常要插提升卡拆分成若干X16与若干X8，同时有的会带额外供电给计算卡[GPU | ThinkSystem SR650V2 | Lenovo Docs](https://pubs.lenovo.com/sr650-v2/zh-CN/gpu_cabling)

两条PCIE 3.0X4、四条PCIE 3.0X16

双网口10G（万兆）Intel X550网卡

八个SASA3接口，可组RAID 0/1/5/10（放心，后面会补充，暂时不知道无所谓）

一个VGA管理口，需要注意这类服务器主板通常有板载显卡，无需额外显卡都能“亮机”，就是不要指望用它进行高强度任务，芯片型号是ASPEED AST2500

三个USB3.2 Gen1（其中一个是TypeA接口另外两个要插线引出两个USB口） 

---

需要注意的是成品服务器不一定告诉你用的主板型号，因此你往往需要通过参数反推具体组件的型号以方便日后维护或升级

举个例子，联想的hr650x，3647准系统千元多，目前闲鱼的性价比之王吧可能

这种整机的参数很难收集，主板多半是定制的（比如什么阿里定制、百度定制），只能上对应官网想办法找到用户手册，像是这个[hr650x手册](https://datacentersupport.lenovo.com/us/en/products/servers/thinksystem-hyperscale/hr650x)，其主板长这样

![hr650xMotherboard](./pics/hr650xMotherboard.png)

而且很多厂商的电源不是那么标准（尤其是联想），因此电源最好从官网那边找他们对应的型号，比如这里hr650x的电源，尽可能找说明了是联想拆机的电源吧，同个牌子不通用的可能性低很多，如果还是同个系列，基本不会不能用，比如RD550、RD450、RD350X电源通用（后两个没有试过，但前者的电源和主板（烧了）我有一个，不是标准crps电源）

![hr650xPSU](./pics/hr650xPSU.png)

过一阵子再补上电源对比图

2024.2.7补充：找了几个安装实例视频，因为国内实在找不到替代，所以我正在缓慢烤肉ing（基于油管字幕进行修改），比如说[联想SR650服务器安装GPU](https://www.bilibili.com/video/BV1LA4m1j7m3/)